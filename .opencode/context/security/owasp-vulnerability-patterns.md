# OWASP Vulnerability Patterns

Focus on HIGH-CONFIDENCE security vulnerabilities with real exploitation potential.

## Input Validation Vulnerabilities

### SQL Injection
- Unsanitized user input in database queries
- Missing parameterized queries or prepared statements
- Direct string concatenation in SQL

**Example Red Flag:**
```python
query = "SELECT * FROM users WHERE id = " + user_input
db.execute(query)
```

### Command Injection
- Unsanitized user input in system calls or subprocesses
- Shell interpretation of user input

**Example Red Flag:**
```python
import os
filename = request.args.get('file')
os.system(f'cat {filename}')
```

### XXE Injection
- XML parsing with external entity processing enabled
- Deserialization of untrusted XML

### Template Injection
- User input in template engines without escaping
- Jinja2, ERB, or similar template vulnerabilities

### NoSQL Injection
- Unsanitized input in NoSQL queries
- Query operators from user input

## Authentication & Authorization Issues

- Authentication bypass logic (hardcoded credentials, flawed checks)
- Privilege escalation paths (user can modify roles/permissions)
- Session management flaws (weak tokens, no expiration)
- JWT vulnerabilities (weak signing, algorithm confusion)
- Authorization logic bypasses (missing checks, IDOR)

## Crypto & Secrets Management

- Hardcoded API keys, passwords, or tokens in code
- Weak cryptographic algorithms (MD5, SHA1)
- Improper key storage or management
- Cryptographic randomness issues (predictable tokens)
- Certificate validation bypasses

## Injection & Code Execution

### Remote Code Execution (RCE)
- Deserialization of untrusted data
- Pickle injection in Python
- YAML deserialization vulnerabilities

### Eval Injection
- Dynamic code execution with user input
- eval(), exec(), or similar with untrusted data

### Cross-Site Scripting (XSS)
- Reflected XSS: User input directly in HTML
- Stored XSS: Unsanitized user input stored and displayed
- DOM-based XSS: JavaScript DOM manipulation with user input
- **Exception**: React/Angular handle XSS safely (unless dangerouslySetInnerHTML)

## Data Exposure

- Sensitive data logging (passwords, tokens, PII)
- Personally identifiable information (PII) handling violations
- API endpoint data leakage (exposing internal IDs, system info)
- Debug information exposure in error messages

## Analysis Approach

1. **Identify Entry Points**: Where does user input enter?
2. **Trace Data Flow**: Follow data through application
3. **Check Validation**: Is input validated/sanitized?
4. **Check Output Encoding**: Is data safely output?
5. **Assess Impact**: What is the exploitation impact?

## Exploitation vs. False Positive

**HIGH CONFIDENCE** indicators:
- Clear, specific attack path identified
- Exploitability demonstrated or obvious
- Real-world vulnerability pattern matched
- High impact potential

**FALSE POSITIVE** indicators:
- Theoretical concern with no concrete attack path
- Requires environment variable control (not exploitable)
- Defense-in-depth issue, not critical vulnerability
- Low probability of exploitation
